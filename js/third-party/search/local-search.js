document.addEventListener("DOMContentLoaded",(()=>{if(CONFIG.path){const e=new LocalSearch({path:CONFIG.path,top_n_per_article:CONFIG.localsearch.top_n_per_article,unescape:CONFIG.localsearch.unescape}),t=document.querySelector(".search-input"),s=()=>{if(e.isfetched){var s=t.value.trim().toLowerCase(),c=s.split(/[-\s]+/),r=document.querySelector(".search-result-container");let a=[];0<s.length&&(a=e.getResultItems(c)),1===c.length&&""===c[0]?(r.classList.add("no-result"),r.innerHTML='<div class="search-result-icon"><i class="fa fa-search fa-5x"></i></div>'):0===a.length?(r.classList.add("no-result"),r.innerHTML='<div class="search-result-icon"><i class="far fa-frown fa-5x"></i></div>'):(a.sort(((e,t)=>e.includedCount!==t.includedCount?t.includedCount-e.includedCount:e.hitCount!==t.hitCount?t.hitCount-e.hitCount:t.id-e.id)),s=CONFIG.i18n.hits.replace("${hits}",a.length),r.classList.remove("no-result"),r.innerHTML=`<div class="search-stats">${s}</div>\n        <hr>\n        <ul class="search-result-list">${a.map((e=>e.item)).join("")}</ul>`,"object"==typeof pjax&&pjax.refresh(r))}},c=(e.highlightSearchWords(document.querySelector(".post-body")),CONFIG.localsearch.preload&&e.fetchData(),"auto"===CONFIG.localsearch.trigger?t.addEventListener("input",s):(document.querySelector(".search-icon").addEventListener("click",s),t.addEventListener("keypress",(e=>{"Enter"===e.key&&s()}))),window.addEventListener("search:loaded",s),document.querySelectorAll(".popup-trigger").forEach((s=>{s.addEventListener("click",(()=>{document.body.classList.add("search-active"),setTimeout((()=>t.focus()),500),e.isfetched||e.fetchData()}))})),()=>{document.body.classList.remove("search-active")});document.querySelector(".search-pop-overlay").addEventListener("click",(e=>{e.target===document.querySelector(".search-pop-overlay")&&c()})),document.querySelector(".popup-btn-close").addEventListener("click",c),document.addEventListener("pjax:success",(()=>{e.highlightSearchWords(document.querySelector(".post-body")),c()})),window.addEventListener("keyup",(e=>{"Escape"===e.key&&c()}))}else console.warn("`hexo-generator-searchdb` plugin is not installed!")}));